// Generated by CoffeeScript 1.3.3
(function() {

  (function(views, models) {
    views.ProjectsContainer = Backbone.View.extend({
      el: $("#projects_container"),
      template: _.template($("#projects-container-tmpl").text()),
      events: {
        'keypress #new_project': 'createNewProject',
        'click #new_project': 'clearInput'
      },
      clearInput: function(e) {
        var text;
        text = $.trim(this.input.val());
        if (text.toLocaleLowerCase() === "create new project") {
          this.input.val("");
        }
      },
      createNewProject: function(e) {
        var p, self, text;
        text = this.input.val();
        if (!text || e.keyCode !== 13) {
          return;
        }
        self = this;
        this.clearInput();
        p = new models.Project({
          title: text
        });
        p.save({}, {
          success: function(model, res) {
            self.collection.clean();
            self.collection.fetch({
              success: function(col, res) {
                self.collection.pager();
                self.input.val("");
              },
              silent: true
            });
          },
          error: function(model, err) {}
        });
      },
      render: function() {
        var html;
        this.$el.empty();
        html = this.template({});
        this.$el.html(html);
        if (views.projectsView) {
          views.projectsView.onClose;
        }
        views.projectsView = new views.ProjectsView({
          collection: this.collection
        });
        if (views.projectPager) {
          views.projectPager.onClose;
        }
        views.projectPager = new views.ProjectsPager({
          collection: this.collection,
          template: "#pagination-tmpl"
        });
        $("#project_navigation").html(views.projectPager.render().el);
        views.projectsView.render();
        this.input = $("#new_project");
      },
      onClose: function() {}
    });
  })(app.views, app.models);

}).call(this);
